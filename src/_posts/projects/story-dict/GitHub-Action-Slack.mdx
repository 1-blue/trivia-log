---
title: GitHub Action + Slack ì•Œë¦¼
description: ì‚¬ì´ë“œ í”„ë¡œì íŠ¸ CI/CD êµ¬ì¶• í›„ Slack ì•Œë¦¼ ê¸°ëŠ¥ ì¶”ê°€ì— ëŒ€í•œ ì´ì•¼ê¸° ( GitHub Actions, Slack )
tags: [story-dict, GitHub, GitHub Actions, Slack]
icon: ''
thumbnail: '/images/posts/projects/story-dict/GitHub-Action-Slack/thumbnail.png'
date: 2025-01-02 19:27:00
sitemap:
  lastmod: 2025-01-02 19:27:00
  changefreq: weekly
  priority: 0.5
draft: false
---

> í•´ë‹¹ í¬ìŠ¤íŠ¸ëŠ” [`GitHub Action`ìœ¼ë¡œ ìë™ ë°°í¬ êµ¬í˜„](./GitHub-Action-CI-CD) í›„ `Slack` ì•Œë¦¼ ê¸°ëŠ¥ ì¶”ê°€ì— ëŒ€í•œ ì´ì•¼ê¸°ì—ìš”<br />
> ì²˜ìŒ í•´ë´¤ëŠ”ë° ì˜ì™¸ë¡œ ê°„ë‹¨í•´ì„œ ì‰½ê²Œ êµ¬í˜„í•  ìˆ˜ ìˆì—ˆì–´ìš”<br />

## Slack ì„¸íŒ…
ë¨¼ì € `Slack`ì— ê°€ì…í•˜ê³  ì±„ë„ì„ ë§Œë“¤ì–´ì¤˜ì•¼í•´ìš”<br />
ì´ ë¶€ë¶„ì€ ëª¨ë‘ í–ˆë‹¤ê³  ê°€ì •í•˜ê³  ê·¸ ì´í›„ë¶€í„° ì‘ì„±í• ê²Œìš”<br />

### App ë§Œë“¤ê¸°
> [Slack API](https://api.slack.com/apps)

1. í˜ì´ì§€ì— ë“¤ì–´ê°€ì„œ `Create New App` ë²„íŠ¼ í´ë¦­
2. `From scratch`ë¥¼ ì„ íƒ
3. ì›í•˜ëŠ” `App Name` ì…ë ¥í•˜ê³ 
4. ì›í•˜ëŠ” `Workspace` ì„ íƒ
5. `Create App` ë²„íŠ¼ í´ë¦­

![Slack App ë§Œë“¤ê¸°](/images/posts/projects/story-dict/GitHub-Action-Slack/1.png)

### Webhook ì„¸íŒ…
> ì €ëŠ” ë°°í¬ ì•Œë¦¼ ì±„ë„ê³¼ ë¹Œë“œ ì•Œë¦¼ ì±„ë„ì„ ë§Œë“¤ì–´ì„œ `Webhook URL`ì´ ë‘ê°œì—ìš”<br />
> ì›í•˜ì‹œëŠ”ë§Œí¼ ì±„ë„ì„ ë§Œë“¤ì–´ì£¼ì‹œë©´ ë¼ìš”<br />

ì´ì œ ë§Œë“¤ì–´ì§„ `App`ì„ ì„ íƒí•´ì¤˜ìš”<br />

1. `Incoming Webhooks` íƒ­ í´ë¦­
2. `Toggle` ë²„íŠ¼ì„ í´ë¦­í•´ì„œ `on`ìœ¼ë¡œ ë³€ê²½
  ![Slack Webhook í™œì„±í™”](/images/posts/projects/story-dict/GitHub-Action-Slack/3.png)
3. `Add New Webhook to Workspace` ë²„íŠ¼ í´ë¦­
4. ì›í•˜ëŠ” ì±„ë„ ì„ íƒ
5. ìƒì„±ëœ `Webhook URL` ë³µì‚¬
  ![Slack Webhook URL ë³µì‚¬](/images/posts/projects/story-dict/GitHub-Action-Slack/4.png)

## GitHub ì„¸íŒ…
### í™˜ê²½ë³€ìˆ˜ ì¶”ê°€
> [GitHub Action í™˜ê²½ë³€ìˆ˜ ì„¤ì •](./GitHub-Action-CI-CD#í™˜ê²½ë³€ìˆ˜-ì„¤ì •)ì„ ì°¸ê³ í•´ì£¼ì„¸ìš”

`Settings` > `Secrets and variables` > `Actions` > `New repository secret`ì—ì„œ í™˜ê²½ë³€ìˆ˜ë¥¼ ì¶”ê°€í•´ì£¼ì„¸ìš”<br />
ì´ë¦„ì€ ì›í•˜ëŠ” ì´ë¦„ìœ¼ë¡œ í•˜ë˜ ê°’ì€ ì•„ê¹Œ ë³µì‚¬í•œ `Webhook URL`ì„ ë„£ì–´ì£¼ì„¸ìš”!<br />
( ì €ëŠ” `SLACK_DEPLOY_WEBHOOK_URL` ê³¼ `SLACK_PR_WEBHOOK_URL` ë‘ê°œë¥¼ ì¶”ê°€í•´ì£¼ì—ˆì–´ìš” )

## yaml ì‘ì„±
> ì €ì˜ ì½”ë“œëŠ” [GitHub](https://github.com/1-blue/story-dict/blob/master/.github/workflows/cicd.yaml)ì—ì„œ ì°¸ê³ í•´ì£¼ì„¸ìš”<br />
> [slackapi/slack-github-action](https://github.com/slackapi/slack-github-action)ë„ í•„ìš”í•˜ì‹œë©´ ì°¸ê³ í•´ì£¼ì„¸ìš”<br />

í¸í•˜ê²Œ í•˜ë ¤ë©´ `8398a7/action-slack@v3`ë¼ëŠ” ì•¡ì…˜ì„ ì‚¬ìš©í•˜ë©´ `fields`ë¥¼ ìˆ˜ë™ìœ¼ë¡œ ì‘ì„±í•˜ì§€ ì•Šì•„ë„ ë¼ìš”<br />
ì €ëŠ” ì œê°€ ì›í•˜ëŠ”ëŒ€ë¡œ ì»¤ìŠ¤í…€í•˜ë ¤ê³  ì§ì ‘ ì‘ì„±í–ˆì–´ìš”<br />

ì „ì²´ ì½”ë“œì¤‘ì— `Slack` ë™ì‘ì„ ìœ„í•œ ì¼ë¶€ë§Œ ê°€ì ¸ì™”ê³ , ìƒì„¸í•œ ë¶€ë¶„ì€ ì•„ë˜ì—ì„œ ì„¤ëª…ë“œë¦´ê²Œìš”<br />

1. `${{  }}`ëŠ” ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•
2. `github.`ì€ `GitHub`ì—ì„œ ì œê³µí•´ì£¼ëŠ” ê°’

```yaml
name: CD with Docker

on:
  push:
    branches: [ "master" ]
  pull_request:
    types: [closed]
    branches: [ "master" ]

permissions:
  contents: read

env:
  SLACK_START_COLOR: "#6366f1"
  SLACK_SUCCESS_COLOR: "#22c55e"
  SLACK_FAILURE_COLOR: "#ef4444"
  SLACK_COMMON_FIELDS: |
    {
      "title": "${{ github.event_name == 'pull_request' && 'PR ì œëª©' || 'ì»¤ë°‹ ë©”ì‹œì§€' }}",
      "value": "${{ github.event_name == 'pull_request' && github.event.pull_request.title || github.event.head_commit.message }}",
      "short": true
    },
    {
      "title": "ì›Œí¬í”Œë¡œìš°",
      "value": "<${{ github.server_url }}/${{ github.repository }}/actions/workflows/cicd.yaml|${{ github.workflow }} ì›Œí¬í”Œë¡œìš°>",
      "short": true
    },
    {
      "title": "ì•¡ì…˜ì‘ì—…",
      "value": "<${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}|#${{ github.run_number }} ì‘ì—…>",
      "short": true
    },
    {
      "title": "ë ˆí¬ì§€í† ë¦¬",
      "value": "<${{ github.server_url }}/${{ github.repository }}|${{ github.repository }}>",
      "short": true
    },
    {
      "title": "${{ github.event_name == 'pull_request' && 'PR ë¸Œëœì¹˜' || 'ë¸Œëœì¹˜' }}",
      "value": "${{ github.event_name == 'pull_request' && format('{0} â†’ {1}', github.event.pull_request.head.ref, github.event.pull_request.base.ref) || github.ref_name }}",
      "short": true
    }

jobs:
  Deploy:
    if: github.event_name == 'push' || (github.event_name == 'pull_request' && github.event.pull_request.merged == true)
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3

    # ì‹œì‘ ì‹œê°„ ì„¤ì •
    - name: Set start time
      run: |
        echo "TZ='Asia/Seoul'" >> $GITHUB_ENV
        echo "START_TIME=$(TZ='Asia/Seoul' date +%s)" >> $GITHUB_ENV
        echo "START_TIME_FORMATTED=$(TZ='Asia/Seoul' date '+%Yë…„ %mì›” %dì¼ %Hì‹œ %Më¶„ %Sì´ˆ')" >> $GITHUB_ENV

    # ì•¡ì…˜ ì´ ì†Œìš”ì‹œê°„ ê³„ì‚°
    - name: Calculate duration
      if: always()
      run: |
        END_TIME=$(date +%s)
        DURATION=$((END_TIME - START_TIME))
        MINUTES=$((DURATION / 60))
        SECONDS=$((DURATION % 60))
        echo "DURATION=${MINUTES}ë¶„ ${SECONDS}ì´ˆ" >> $GITHUB_ENV

    # ë°°í¬ ì‹œì‘ ì•Œë¦¼
    - name: Notify Slack on Start
      id: slack-start
      uses: slackapi/slack-github-action@v1.24.0
      with:
        payload: |
          {
            "attachments": [
              {
                "color": "${{ env.SLACK_START_COLOR }}",
                "title": "ğŸš€ ë°°í¬ ì‹œì‘ ğŸš€",
                "text": "${{ github.event_name == 'pull_request' && format('{0} â†’ {1}', github.event.pull_request.head.ref, github.event.pull_request.base.ref) || github.ref_name }}",
                "fields": [
                  {
                    "title": "ì‹œì‘ì‹œê°„",
                    "value": "${{ env.START_TIME_FORMATTED }}",
                    "short": true
                  },
                  ${{ env.SLACK_COMMON_FIELDS }}
                ]
              }
            ]
          }
      env:
        SLACK_WEBHOOK_URL: ${{ secrets.SLACK_DEPLOY_WEBHOOK_URL }}
        SLACK_WEBHOOK_TYPE: INCOMING_WEBHOOK

    # ... ë¹Œë“œ ë° ë°°í¬ ì‘ì—… ì²˜ë¦¬

    # ë°°í¬ ì„±ê³µ ì•Œë¦¼
    - name: Notify Slack on Success
      if: success()
      uses: slackapi/slack-github-action@v1.24.0
      with:
        payload: |
          {
            "attachments": [
              {
                "color": "${{ env.SLACK_SUCCESS_COLOR }}",
                "title": "â­•ï¸ ë°°í¬ ì„±ê³µ â­•ï¸",
                "text": "${{ github.event_name == 'pull_request' && format('{0} â†’ {1}', github.event.pull_request.head.ref, github.event.pull_request.base.ref) || github.ref_name }}",
                "fields": [
                  {
                    "title": "ì†Œìš”ì‹œê°„",
                    "value": "${{ env.DURATION }}",
                    "short": true
                  },
                  ${{ env.SLACK_COMMON_FIELDS }}
                ]
              }
            ]
          }
      env:
        SLACK_WEBHOOK_URL: ${{ secrets.SLACK_DEPLOY_WEBHOOK_URL }}
        SLACK_WEBHOOK_TYPE: INCOMING_WEBHOOK

    # ë°°í¬ ì‹¤íŒ¨ ì•Œë¦¼
    - name: Notify Slack on Failure
      if: failure()
      id: slack-failure
      uses: slackapi/slack-github-action@v1.24.0
      with:
        payload: |
          {
            "attachments": [
              {
                "color": "${{ env.SLACK_FAILURE_COLOR }}",
                "title": "âŒ ë°°í¬ ì‹¤íŒ¨ âŒ",
                "text": "${{ github.event_name == 'pull_request' && format('{0} â†’ {1}', github.event.pull_request.head.ref, github.event.pull_request.base.ref) || github.ref_name }}",
                "fields": [
                  {
                    "title": "ì†Œìš”ì‹œê°„",
                    "value": "${{ env.DURATION }}",
                    "short": true
                  },
                  ${{ env.SLACK_COMMON_FIELDS }}
                ]
              }
            ]
          }
      env:
        SLACK_WEBHOOK_URL: ${{ secrets.SLACK_DEPLOY_WEBHOOK_URL }}
        SLACK_WEBHOOK_TYPE: INCOMING_WEBHOOK
```

### ë³€ìˆ˜ ì„¤ì •

### ì‚¬ìš©ë²•
`payload`ì— `webhook`ìœ¼ë¡œ ì „ë‹¬í•  ë°ì´í„°ë¥¼ ë„£ì–´ì£¼ë©´ ë¼ìš”<br />

1. `color`: `slack` ë©”ì‹œì§€ ì¢Œì¸¡ ë¼ì¸ ìƒ‰ìƒ
2. `title`: `slack` ë©”ì‹œì§€ ì œëª©
3. `text`: `slack` ë©”ì‹œì§€ ë‚´ìš©
4. `fields`: `slack` ë©”ì‹œì§€ í•„ë“œ
5. 19ë²ˆ ë¼ì¸ì€ ìœ„ì—ì„œ ì„¤ì •í•œ ë³€ìˆ˜

![250102-201000](/images/posts/projects/story-dict/GitHub-Action-Slack/5.png)


```yaml {showLineNumbers} {10-19}
  # ë°°í¬ ì‹œì‘ ì•Œë¦¼
  - name: Notify Slack on Start
    id: slack-start
    uses: slackapi/slack-github-action@v1.24.0
    with:
      payload: |
        {
          "attachments": [
            {
              "color": "${{ env.SLACK_START_COLOR }}",
              "title": "ğŸš€ ë°°í¬ ì‹œì‘ ğŸš€",
              "text": "${{ github.event_name == 'pull_request' && format('{0} â†’ {1}', github.event.pull_request.head.ref, github.event.pull_request.base.ref) || github.ref_name }}",
              "fields": [
                {
                  "title": "ì‹œì‘ì‹œê°„",
                  "value": "${{ env.START_TIME_FORMATTED }}",
                  "short": true
                },
                ${{ env.SLACK_COMMON_FIELDS }}
              ]
            }
          ]
        }
    env:
      SLACK_WEBHOOK_URL: ${{ secrets.SLACK_DEPLOY_WEBHOOK_URL }}
      SLACK_WEBHOOK_TYPE: INCOMING_WEBHOOK
```

## ë§ˆë¬´ë¦¬
1. ì•¡ì…˜ ì‹¤í–‰ ì‹œê°„ì„ ê³„ì‚°í•˜ê¸° ìœ„í•œ ì²˜ë¦¬
2. `Push`ì™€ `Pull Request`ì— ì˜í•œ ë³‘í•©ì— ëŒ€í•œ ì²˜ë¦¬ë¥¼ ìœ„í•œ ë¶„ê¸°ì²˜ë¦¬

ìœ„ ë‘ê°€ì§€ì— ëŒ€í•œ ì„¤ëª…ì„ í•˜ì§€ëŠ” ì•Šì•˜ëŠ”ë° í•´ë‹¹ ë¶€ë¶„ì€ êµ³ì´ ì„¤ëª…í•˜ì§€ ì•Šê³  ì½”ë“œë§Œ ì½ì–´ë´ë„ ì´í•´ê°€ ë ê±°ì—ìš”<br />
í•„ìš”í•œ í˜•íƒœê°€ ìˆë‹¤ë©´ [slackapi/slack-github-action](https://github.com/slackapi/slack-github-action)ë¥¼ ì°¸ê³ í•´ì„œ ì¶”ê°€í•˜ë©´ ë˜ê³ , ì„±ê³µì´ë‚˜ ì‹¤íŒ¨ì˜ ê²½ìš°ë„ ê±°ì˜ ë™ì¼í•˜ê²Œ ì¶”ê°€í•´ì£¼ë©´ ë¼ìš”<br />